let tracklist = [
    {
        num: 1,
        song: `Losing My Edge`,
        artist: `LCD Soundsystem`,
        album: `Electricity (A Brief History Of Future Sound)`,
        year: 2012,
        duration: `7:53`,
        yt_link: `https://www.youtube.com/embed/ZUjDMdSwefk`,
        discogs_release: `3774872`,
        wiki: ``,
        notes: `How I feel trying to do anything or be anyone. ‚ÄúI heard you have a compilation of every good song ever done by anybody.‚Äù`,
        sounds: `<div class="tag">me making this...</div>`,
        fav: `true`,
    }, 
    {
        num: 2,
        song: `Spin Spin Sugar (Armand's Dark Garage Mix)`,
        artist: `Sneaker Pimps`,
        album: `MTV Grind Vol. 1`,
        year: 1997,
        duration: `9:04`,
        yt_link: `https://www.youtube.com/embed/lYzOrpWL6U8`,
        discogs_release: `4088687`,
        wiki: ``,
        notes: `This and the next song are both on MTV Grind Vol. 1, which was released for MTV's 'The Grind Workout'. They also had a matching clothing line called "Grind Sport". <a href= 'https://www.youtube.com/watch?v=L6uyNpISHL0' target='_blank'>Here</a> is the full compilation.`,
        sounds: `<div class="tag">vertigo in the club</div>`,
        fav: `true`,
    }, 
    {
        num: 3,
        song: `Sugar Is Sweeter (Armand‚Äôs Drum & Bass Mix)`,
        artist: `CJ Bolland`,
        album: `MTV Grind Vol. 1`,
        year: 1997,
        duration: `8:36`,
        yt_link: `https://www.youtube.com/embed/on7ay2MA-Ok`,
        discogs_release: `4088687`,
        wiki: ``,
        notes: ``,
        sounds: ``,
        fav: ``,
    },
    {
        num: 4,
        song: `45:33 (Pilooski Remix)`,
        artist: `LCD Soundsystem`,
        album: `The Man Machine (Mojo celebrates the electronic revolution)`,
        year: 2009,
        duration: `6:49`,
        yt_link: `https://www.youtube.com/embed/TXaF-0kLmF8`,
        discogs_release: `1952980`,
        wiki: ``,
        notes: `I keep hearing "We accept the French" rather than "Will you accept our friendship?"`,
        sounds: `<div class="tag">a symbiotic relationship between a brain + the numerous small machines that operate it</div>`,
        fav: ``,
    },
    {
        num: 5,
        song: "Insect Near Piha Beach",
        artist: `Four Tet`,
        album: `Sixteen Oceans`,
        year: 2020,
        duration: `5:16`,
        yt_link: `https://www.youtube.com/embed/exYtXUxe5d4`,
        discogs_release: `15565519`,
        wiki: ``,
        notes: `I found this album for 99 cents in the suburbs. Still don‚Äôt know how that happened.`,
        sounds: `<div class="tag">dew</div><div class="tag">forest shade</div><div class="tag">a very reflective beetle</div><div class="tag">a large insect colony</div>`,
        fav: ``,
    },
    {
        num: 6,
        song: `Subduction (Continental Version)`,
        artist: `Hanssen, Piper Davis`,
        album: `Transit`,
        year: 2016,
        duration: `5:59`,
        yt_link: `https://www.youtube.com/embed/x7WteyoV09Q`,
        discogs_release: `27020385`,
        wiki: ``,
        notes: `This is the cassette track. The artist is quite unknown, but this is definitely one of my favorite tracks in here‚Ä¶ Coconut Palm Forest from this album is also amazing.`,
        sounds: `<div class="tag">journey of a lone satellite</div><div class="tag">all that has ever existed</div>`,
        fav: `true`,
    },
    {
        num: 7,
        song: `Human Behavior`,
        artist: `Bj√∂rk`,
        album: `Debut`,
        year: 1993,
        duration: `4:12`,
        yt_link: `https://www.youtube.com/embed/6ml8KDumTO0`,
        discogs_release: `2431`,
        wiki: ``,
        notes: ``,
        sounds: `<div class="tag">singing down towards the earth</div><div class="tag">for some reason in my mind there's a transparent surface between Bj√∂rk's voice and the Earth</div>`,
        fav: ``,
    },
    {
        num: 8,
        song: `Free to Choose, Hard to Be`,
        artist: `Statik Sound System`,
        album: `Temptesta II`,
        year: 1997,
        duration: `4:29`,
        yt_link: `https://www.youtube.com/embed/_OCfI1iBbBw`,
        discogs_release: `28329`,
        wiki: ``,
        notes: ``,
        sounds: `<div class="tag">serial experiments lain</div>`,
        fav: `true`,
    },
    {
        num: 9,
        song: `If I Was Your Girlfriend`,
        artist: `TLC`,
        album: `CrazySexyCool`,
        year: 1994,
        duration: `4:37`,
        yt_link: `https://www.youtube.com/embed/M_o_lSiNAtI`,
        discogs_release: `8950062`,
        wiki: ``,
        notes: `I had to include TLC on here somehow. This playlist started out very TLC heavy, but as I worked on it, I realized I had forgotten about many of the electronic CDs I bought in the summer. This isn‚Äôt my favorite TLC song, but the intro scratches a particular itch and also fits well here. I love the intro. I didn‚Äôt know this was a cover of Prince since I didn‚Äôt grow up listening to anything other than 2010s pop and country radio in the car üíî This cover is distinctly 90s girl group, but the original has so much more sensuality and depth (go listen to Prince).`,
        sounds: ``,
        fav: ``,
    },
    {
        num: 10,
        song: "Be No One",
        artist: `Charles Webster`,
        album: `Back to Mine: The Orb`,
        year: 2003,
        duration: `5:26`,
        yt_link: `https://www.youtube.com/embed/TY7YFnoi2yE`,
        discogs_release: `565185`,
        wiki: ``,
        notes: `This compilation CD from The Orb is one of the first CDs I bought myself. Also still one of the best in my collection. The Twin Peaks theme is on here and so is a convoluted version of the Barbie song? Another classic is <a href='https://www.youtube.com/watch?v=vTbjhvs1gHI' target='_blank'>"I Wanna Be a Fishy"</a>, which goes, ‚ÄúI wanna be a little fishy, yes I do, yes I do, yes I dooo. I wanna swim around and be a little fish clown cause it is so cool to be under the waterrrr‚Äù (actually unironically a song I find really great) <br> Also look at the <a href="https://www.discogs.com/release/565185-The-Orb-Back-To-Mine/image/SW1hZ2U6NTE4MjQ5Ng==" target="_blank">track commentary</a> on this thing. "Would you let your daughter near this man?" (about Aphex Twin)`,
        sounds: ``,
        fav: ``,
    },
    {
        num: 11,
        song: `Air Batucada`,
        artist: `Thievery Corporation`,
        album: `The Mirror Conspiracy`,
        year: 2000,
        duration: `4:44`,
        yt_link: `https://www.youtube.com/embed/up8hZoj7y20`,
        discogs_release: `3477`,
        wiki: ``,
        notes: `Maybe the real mirror conspiracy is the fact that this reflective disc looks the same on the front and back.... Also 444...Chinese numerology strikes again, I can never escape it....`,
        sounds: ``,
        fav: ``,
    },
    {
        num: 12,
        song: `Maria Moita`,
        artist: `Rosalia de Souza`,
        album: `Garota Moderna`,
        year: 2002,
        duration: `5:16`,
        yt_link: `https://www.youtube.com/embed/h7A-uxBzb2U`,
        discogs_release: `2039308`,
        wiki: ``,
        notes: ``,
        sounds: ``,
        fav: `true`,
    },
    {
        num: 13,
        song: `Treasures`,
        artist: `Thievery Corporation`,
        album: `The Mirror Conspiracy`,
        year: 2000,
        duration: `2:22`,
        yt_link: `https://www.youtube.com/embed/6Iplg4WT9Gw`,
        discogs_release: `3477`,
        wiki: ``,
        notes: `222... Wow, that is half of 444....`,
        sounds: ``,
        fav: ``,
    },
    {
        num: 14,
        song: `It's a Woman's World`,
        artist: `Zuco 103, Lee Scratch Perry`,
        album: `Whaa!`,
        year: 2005,
        duration: `3:19`,
        yt_link: `https://www.youtube.com/embed/9bZwbhhc2gE`,
        discogs_release: `3508197`,
        wiki: ``,
        notes: `This album snapped me out of a depressive lull when I was digging through CDs. Garota Moderna (two tracks ago) did this as well. The first track of this album, Na Mangueira, is what I can only describe as delightful.`,
        sounds: `<div class="tag">pure joy!</div><div class="tag">Sunday morning</div>`,
        fav: ``,
    },
    {
        num: 15,
        song: `Renegade Master (Fatboy Slim Old Skool Mix)`,
        artist: `Wildchild`,
        album: `Structure Amplified 01`,
        year: 2000,
        duration: `5:59`,
        yt_link: `https://www.youtube.com/embed/g-kz7o9g2X4`,
        discogs_release: `5257314`,
        wiki: ``,
        notes: `This is the CD that starts with Stereolab and ends with Nina Simone. Possibly questionable compilation but I personally like it.`,
        sounds: ``,
        fav: ``,
    },
    {
        num: 16,
        song: `Amazone Hunt`,
        artist: `Avalanche`,
        album: `Paris is Sleeping, Respect is Burning Vol. 2`,
        year: 1999,
        duration: `6:15`,
        yt_link: `https://www.youtube.com/embed/b6jFcxFh0k4`,
        discogs_release: `51732`,
        wiki: ``,
        notes: `My favorite CD on here. listen to it <a href="https://www.youtube.com/playlist?list=PLzzDc3jvMzxPdfvvO3L8p2Og_bPkbsz-6" target="_blank">here</a>.`,
        sounds: ``,
        fav: `true`,
    }
];


tracklist.forEach((track, index) => {
    track.originalNum = index + 1;
    track.discogs_release = getDiscogsLink(track.discogs_release);
});

function getDiscogsLink(release) {
    if (!release) return '';
    const link = 'https://www.discogs.com/release/' + release;
    return link;
}

function renderList(data) {    
        const template = '{{#tracklist}} <div class="track-container {{#fav}}fav-track{{/fav}} "> <button type="button" class="coll-closed track-toggle"> <h1 class="track-num">{{num}}</h1> <img class="album-icon" src="{{originalNum}}.png"> <div class="song-info"> <h3>{{song}}</h3> <p>{{artist}}</p> </div> <p class="album">{{album}}</p> <p class="duration">{{duration}}</p> </button> <div class="content_closed"> <div class="media-container"> <table cellspacing="0"> <tr> <th>Song</th> <td>{{song}}</td> </tr> <tr> <th>Artist</th> <td>{{artist}}</td> </tr> <tr> <th>Album</th> <td>{{album}}</td> </tr> <tr> <th>Year</th> <td>{{year}}</td> </tr></table>{{#yt_link}}<iframe class="vid" src="{{.}}?autoplay=0" title="YouTube video player" frameborder="0" modestbranding allowfullscreen></iframe>{{/yt_link}} </div> {{#notes}}<div class="media-container"> <h3>Notes:</h3> <p>{{{.}}}</p> </div>{{/notes}}{{#sounds}}<div class="media-container tags"> <h3>Sounds like:</h3>{{{.}}}</div>{{/sounds}} <div class="music-link-container"> {{#discogs_release}}<div class="music-link"> <img src="../img/icons/discogs.png"> <a href="{{.}}" target="_blank"><p>album discogs</p></a> </div> {{/discogs_release}}{{#wiki}}<div class="music-link"> <img src="../img/icons/wiki.png"> <a href="{{.}}" target="_blank"><p>artist wiki</p></a> </div> {{/wiki}}</div> </div> </div> {{/tracklist}}';

    const rendered = Mustache.render(template, {tracklist: data});
    document.getElementById('tracklist-placeholder').innerHTML = rendered;
    initTracklistInteractions();
}

function setActiveSortButton(activeClass) {
    const buttons = document.querySelectorAll('.sort-btn');
    buttons.forEach(btn => btn.classList.remove('active'));

    const activeBtn = document.querySelector(`.sort-btn.${activeClass}`);
    if (activeBtn) activeBtn.classList.add('active');
}

function sortByDefault() {
    const sorted = [...tracklist].sort((a, b) => a.originalNum - b.originalNum);
    sorted.forEach((track, index) => {
    track.num = index + 1;
    });
    renderList(sorted);
    setActiveSortButton('sort-default');
}
function sortByYear() {
    const sorted = [...tracklist].sort((a, b) => (a.year || 0) - (b.year || 0));
    sorted.forEach((track, index) => {
    track.num = index + 1;
    });

    renderList(sorted);
    setActiveSortButton('sort-year');
}


renderList(tracklist);
    